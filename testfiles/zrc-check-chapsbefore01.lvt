\documentclass{book}

\input{regression-test}

\usepackage{zref-check}

\begin{document}

\START

\zrctarget{txt:target-0}{Lorem ipsum}

\zrcheck{txt:target-0}[chapsbefore]{this check should fail}

\zrcheck{cha:chapter-1}[chapsbefore]{this check should fail}

\zrcheck{cha:chapter-2}[chapsbefore]{this check should fail}

\zrcheck{cha:chapter-3}[chapsbefore]{this check should fail}

\zrcheck{cha:chapter-4}[chapsbefore]{this check should fail}

\OMIT
\chapter{Chapter 1}
\zlabel{cha:chapter-1}
\TIMO

\zrcheck{txt:target-0}[chapsbefore]{this check should fail}

\zrcheck{cha:chapter-1}[chapsbefore]{this check should fail}

\zrcheck{cha:chapter-2}[chapsbefore]{this check should fail}

\zrcheck{cha:chapter-3}[chapsbefore]{this check should fail}

\zrcheck{cha:chapter-4}[chapsbefore]{this check should fail}

\OMIT
\chapter{Chapter 2}
\zlabel{cha:chapter-2}
\TIMO

\zrcheck{txt:target-0}[chapsbefore]{this check should fail}

\zrcheck{cha:chapter-1}[chapsbefore]{this check should pass}

\zrcheck{cha:chapter-2}[chapsbefore]{this check should fail}

\zrcheck{cha:chapter-3}[chapsbefore]{this check should fail}

\zrcheck{cha:chapter-4}[chapsbefore]{this check should fail}

\OMIT
\chapter{Chapter 3}
\zlabel{cha:chapter-3}
\TIMO

\zrcheck{txt:target-0}[chapsbefore]{this check should fail}

\zrcheck{cha:chapter-1}[chapsbefore]{this check should pass}

\zrcheck{cha:chapter-2}[chapsbefore]{this check should pass}

\zrcheck{cha:chapter-3}[chapsbefore]{this check should fail}

\zrcheck{cha:chapter-4}[chapsbefore]{this check should fail}

\OMIT
\chapter{Chapter 4}
\zlabel{cha:chapter-4}
\TIMO

\zrcheck{txt:target-0}[chapsbefore]{this check should fail}

\zrcheck{cha:chapter-1}[chapsbefore]{this check should pass}

\zrcheck{cha:chapter-2}[chapsbefore]{this check should pass}

\zrcheck{cha:chapter-3}[chapsbefore]{this check should pass}

\zrcheck{cha:chapter-4}[chapsbefore]{this check should fail}

\OMIT

\end{document}
